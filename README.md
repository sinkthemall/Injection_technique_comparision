# Injection_technique_comparision
Comparision between various of injection techniques. List of injection techniques in this comparision was referenced from here: https://github.com/itaymigdal/awesome-injection?tab=readme-ov-file#section-mapping-injection

In my opinion, there are 2 main reasons why injection is need:
+   Change the target process behaviour, control flow.
+   Evade EDR/AV


### Comparision

| **Injection tecnique**            | **Stealth, detection rate**           | **Methodology - How it work**                                                                                                                                     | **APIs**                                                                                                                   | **Persitence** | **Target**                                      | **implementation complexity**     | **Impact**                                                 |
|-----------------------------------|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|----------------|-------------------------------------------------|-----------------------------------|------------------------------------------------------------|
| process Injection                 | Easy being spotted by EDR/AV          | Alloc mem (RWX) -> Copy shellcode -> Create new remote thread to shellcode                                                                                        | VirtualAllocEx, WriteProcessMemory, CreateRemoteThread                                                                     | Process memory | Process                                         | medium (base on the shellcode)    | Current Process                                            |
| DLL injection                     |                                       | Load library -> Library execute DLLMain -> code execute                                                                                                           | LoadLibrary, WriteProcessMemory, CreateRemoteThread (for loading dll)                                                      | Process memory | Process                                         | easy                              | Current Process                                            |
| reflective DLL                    | Less attention than Process injection | Copy DLL to target memory -> DLL contain reflective loader -> Re-control flow to reflective loader -> Loader parsing DLL header, relocation, then execute DLLMain | VirtualAllocEx, WriteProcessMemory, CreateRemoteThread                                                                     | process memory | Process                                         | hard                              | Current Process                                            |
| DLL injection via SetWindowHookEx |                                       | Inject Hook function to Window Procedure Message Handling chain -> trigger when required window message is met.                                                   | SetWindowsHookEx, LoadLibraryA                                                                                             | process memory | Process/Window Procedure Message Handling chain | medium                            | Depend on arg in Setwindowshook Sometimes it can be global |
| Section Mapping                   |                                       | Section is a shared memory between process. Mapping section between processes and create thread to control flow to mapped section.                                | CreateRemoteThreadEx, NtMapViewOfSection                                                                                   | process memory | Process                                         | easy                              | Can be global, base on the number of process map to        |
| APC Queue injection               |                                       | Thread can execute asynchronously by leveraging APC queue. The way this injection work is by searching all thread and injecting all APC the shellcode address     | VirtualAllocEx, WriteProcessMemory (for write shellcode),CreateToolhelp32Snapshot, OpenThread, ... (for inject APC queue)  | process memory | Process/Thread                                  |                                   | Current Process                                            |
| PE injection                      |                                       | This affect to the file rather than process, by changing the file (inject shellcode, alter Entry Point, TLS Callback adding, ... ) shellcode can be executed.     | (depend on how you write to file)                                                                                          | File           | File                                            | medium (base on how you alter it) | File                                                       |

More injection tehniques will be added in future