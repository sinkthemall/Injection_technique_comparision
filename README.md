# Injection_technique_comparision
Comparision between various of injection techniques. List of injection techniques in this comparision was referenced from here: https://github.com/itaymigdal/awesome-injection?tab=readme-ov-file#section-mapping-injection

In my opinion, there are 2 main reasons why injection is need:
+   Change the target process behaviour, control flow.
+   Evade EDR/AV


### Comparision

| **Injection tecnique**            | **Stealth, detection rate**           | **Methodology - How it work**                                                                                                                                     | **APIs**                                                                                                                   | **Persitence** | **implementation complexity**  | **Impact**                                                 |
|-----------------------------------|---------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|----------------|--------------------------------|------------------------------------------------------------|
| process Injection                 | Easy being spotted by EDR/AV          | Alloc mem (RWX) -> Copy shellcode -> Create new remote thread to shellcode                                                                                        | VirtualAllocEx, WriteProcessMemory, CreateRemoteThread                                                                     |                | medium (base on the shellcode) | Target Process                                             |
| DLL injection                     |                                       | Load library -> Library execute DLLMain -> code execute                                                                                                           | LoadLibrary, WriteProcessMemory, CreateRemoteThread (for loading dll)                                                      |                | easy                           | Target Process                                             |
| reflective DLL, PE injection      | Less attention than Process injection | Copy DLL to target memory -> DLL contain reflective loader -> Re-control flow to reflective loader -> Loader parsing DLL header, relocation, then execute DLLMain | VirtualAllocEx, WriteProcessMemory, CreateRemoteThread                                                                     |                | hard                           | Target Process                                             |
| DLL injection via SetWindowHookEx |                                       | Inject Hook function to Window Procedure Message Handling chain -> trigger when required window message is met.                                                   | SetWindowsHookEx, LoadLibraryA                                                                                             |                | medium                         | Depend on arg in Setwindowshook Sometimes it can be global |
| Section Mapping                   |                                       | Section is a shared memory between process. Mapping section between processes and create thread to control flow to mapped section.                                | CreateRemoteThreadEx, NtMapViewOfSection                                                                                   |                | easy                           | Can be global, base on the number of process map to        |
| APC Queue injection               |                                       | Thread can execute asynchronously by leveraging APC queue. The way this injection work is by searching all thread and injecting all APC the shellcode address     | VirtualAllocEx, WriteProcessMemory (for write shellcode),CreateToolhelp32Snapshot, OpenThread, ... (for inject APC queue)  |                |                                | Target Process                                             |

More injection tehniques will be added in future